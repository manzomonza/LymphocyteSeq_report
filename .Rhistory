getwd()
setwd('../LymphocyteSeq')
devtools::document()
warnings()
devtools::document()
testfiles = c('./input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101340383.clone_summary.csv',
'./input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101403744.clone_summary.csv',
'./input/TCR/W2406_K2022.1455_20220903012053696.clone_summary.csv',
'./input/TCR/W2406_K2022.1455_20220903012128818.clone_summary.csv')
clonesum_read(testfiles[1])
clonesum_read(testfiles[1]) |> plot_prep()
library(magrittr)
clonesum_read(testfiles[1]) |> plot_prep()
clonesum_read("/Users/manzo/USB/USB_Diagnostics/LymphocyteSeq/input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101340383.lineage_summary.csv")
clonesum_read(testfiles[4])
#' Return top25 clones of TCR cloneummaries formatted for presentation in Data Table
#'
#' @param lineage_file
#'
#' @return
#' @export
#'
#' @examples
top25_lineage_selection_tcr <- function(clonesum){
selection = head(clonesum, n = 25) %>%
dplyr::select(variable, joining, cdr3_aa, frequency, total_counts)
selection$frequency = round(selection$frequency, digits = 3)
colnames(selection) = gsub("_", " ",stringr::str_to_title(colnames(selection)))
return(selection)
}
devtools::document9)
devtools::document()
devtools::document()
devtools::document()
testthat::test_that(desc = "Correct retrieval of lineage summaries",
code = {
inputstring = testdir
testthat::expect_equal(list_lineage_summaries(inputstring),
c("/Users/manzo/USB/USB_Diagnostics/LymphocyteSeq/input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101340383.lineage_summary.csv",
"/Users/manzo/USB/USB_Diagnostics/LymphocyteSeq/input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101403744.lineage_summary.csv")
)
}
)
testdir='/Users/manzo/USB/USB_Diagnostics/LymphocyteSeq/input/BCR/W3525_BCR'
testthat::test_that(desc = "Correct retrieval of lineage summaries",
code = {
inputstring = testdir
testthat::expect_equal(list_lineage_summaries(inputstring),
c("/Users/manzo/USB/USB_Diagnostics/LymphocyteSeq/input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101340383.lineage_summary.csv",
"/Users/manzo/USB/USB_Diagnostics/LymphocyteSeq/input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101403744.lineage_summary.csv")
)
}
)
list_lineage_summaries(inputstring)
list_lineage_summaries(testdir)
panel_dataframe(list_lineage_summaries(testdir))
panel_dataframe(list_lineage_summaries(testdir))[[1]]
panel_dataframe(list_lineage_summaries(testdir))[[1]]
panel_dataframe(list_lineage_summaries(testdir))[[1]]$filepath
panel_dataframe(list_lineage_summaries(testdir))[[1]]$filepath
panel_dataframe(list_lineage_summaries(testdir))[[1]]
lineage_df = panel_dataframe(list_lineage_summaries(testdir))[[1]]
lineage_df$filepath
clonesum_read("/Users/manzo/USB/USB_Diagnostics/LymphocyteSeq/input/BCR/W3525_BCR/W3525_B2022.50915_v1_20221204101340383.lineage_summary.csv")
devtools::document()
